<!DOCTYPE html>
<html lang="en">
<head>
    <title>Steve Johnson – <span class="caps">PCG32</span>: The Perfect <span class="caps">PRNG</span> for&nbsp;Roguelikes</title>

    <meta name="viewport" content="width=device-width">
    <meta charset="UTF-8">

    <link href='http://fonts.googleapis.com/css?family=Playfair+Display:400,700,400italic&subset=latin,latin-ext' rel='stylesheet'>
    <link href='http://fonts.googleapis.com/css?family=Playfair+Display+SC' rel='stylesheet'>
    <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet'>

    <link rel="stylesheet" href="http://steveasleep.com/css/reset.css" />
    <link rel="stylesheet" href="http://steveasleep.com/css/pygments.css" />
    <link rel="stylesheet" href="http://steveasleep.com/css/style.css" />

    <!--
    <meta charset="utf-8" />
      <link href="http://steveasleep.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Steve Johnson Full Atom Feed" />
      <link href="http://steveasleep.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Steve Johnson Full RSS Feed" />
      <link href="http://steveasleep.com/feeds/posts.atom.xml" type="application/atom+xml" rel="alternate" title="Steve Johnson Categories Atom Feed" />
    -->

    <script src="http://steveasleep.com/js/hyphenate.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="http://steveasleep.com/js/main.js"></script>

</head>

<body>
  <header id="banner" class="body">
    <h1>
      <a href="http://steveasleep.com">
        <!--Steve Johnson <strong></strong>-->
        <!--Steve Johnson&rsquo;s<br>partial creative output-->
        Steve Johnson #6,059
      </a>
    </h1>
  </header>

  <div id="layoutcontainer">
    <div id="pagecontainer">
      <nav id="menu">
        <ul>
            <li><a href="http://steveasleep.com/">Blog</a></li>
            <li><a href="http://steveasleep.com/pyglettutorial.html">Pyglet tutorial</a></li>
            <li><a href="http://steveasleep.com/resume.html">Résumé</a></li>
            <li><a href="http://steveasleep.com/game-jam-cv.html">Game jam CV</a></li>
            <li><a href="http://sendimals.com">Sendimals</a></li>
            <li><a href="https://ldjam.com/events/ludum-dare/38/rogue-basement">Rogue Basement</a></li>
            <li><a href="http://literallycanvas.com/">Literally Canvas</a></li>
            <li><a href="http://steveasleep.com/computerwords">Computer Words</a></li>
            <li><a href="http://mrjob.readthedocs.org/">mrjob</a></li>
            <li><a href="http://hipmunk.github.io">Hipmunk OSS</a></li>
            <li><a href="http://steveasleep.com/games.html">Old games</a></li>
            <li><a href="http://thenestmusic.com">The Nest</a></li>
            <li><a href="http://slamjamsen.com">Slam Jamsen</a></li>
            <li><a href="https://github.com/irskep">GitHub</a></li>
            <li><a href="https://twitter.com/irskep">Twitter</a></li>
            <li><a href="https://www.last.fm/user/irskep">last.fm</a></li>
            <li><a href="mailto:randos@steve.steveasleep.com">Email</a></li>
        </ul>
      </nav>

  <section id="content" class="body"><article class="article">
      <header class="article-header">
    <h1 class="entry-title">
      <a href="http://steveasleep.com/pcg32-the-perfect-prng-for-roguelikes.html" rel="bookmark" title="Permalink to PCG32: The Perfect PRNG for Roguelikes">
        <span class="caps">PCG32</span>: The Perfect <span class="caps">PRNG</span> for&nbsp;Roguelikes
      </a>
    </h1>
    <div class="post-info">
        <time class="published" datetime="2018-03-14T00:00:00-07:00">
          14 Mar 2018
        </time>
    </div>
  </header>

    <div class="entry-content hyphenate"><p>Category: Articles
Slug:&nbsp;pcg32-the-perfect-prng-for-roguelikes</p>
<p>Tags: gamedev roguelikes
Status:&nbsp;draft</p>
<p>A <strong>pseudo-random number generator</strong> uses math to generate numbers that appear
random to users, but are completely deterministic. They are used in roguelike
games to generate levels, determine combat outcomes, and much&nbsp;more.</p>
<p>In roguelikes, each game typically has a unique <em>random seed</em>. This seed
affects how the generated levels are laid out. That way, players can share
seeds with each other to see who does better in the same&nbsp;situation.</p>
<p>When designing a roguelike, it can be tricky to design the game so that the
levels turn out the same way every time for every game. We must be careful not
to use the same <span class="caps">PRNG</span> instance for both level generation and combat, for
example, or else the player&#8217;s actions during the game will affect how future
maps&nbsp;look!</p>
<p>But if you use the <a href="http://www.pcg-random.org"><span class="caps">PCG</span> family of PRNGs</a>, our job
is a lot easier. There are many variants of <span class="caps">PCG</span>, but in this post I&#8217;ll be
referring only to <span class="caps">PCG32</span>, the one that generates 32-bit unsigned integers and
keeps its state as two 64-bit unsigned&nbsp;integers.</p>
<h1 id="what-makes-pcg-unique">What makes <span class="caps">PCG</span>&nbsp;unique?</h1>
<p><span class="caps">PCG</span> has a lot going for it, and <a href="http://www.pcg-random.org">the web site does a good job of explaining
the advantages</a>, but for roguelike developers, it
all comes down to the <span class="caps">API</span> (<a href="https://github.com/imneme/pcg-c-basic/blob/master/pcg_basic.h">source</a>).</p>
<p>A <span class="caps">PCG</span> instance is created with not one, but <strong>two</strong> values: the <em>seed</em>, and the
<em>stream</em>. The seed matches the traditional idea of a <span class="caps">PRNG</span> seed, but the stream
is something new: it lets you pick from <em>multiple streams of random numbers</em>
generated by the same&nbsp;seed!</p>
<div class="highlight"><pre><span></span><span class="n">Seed</span><span class="o">:</span> <span class="mi">12345</span>
<span class="n">Stream</span> <span class="mi">0</span><span class="o">:</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">26</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">74</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">82</span><span class="o">,</span> <span class="mi">86</span><span class="o">,</span> <span class="mi">75</span><span class="o">,</span> <span class="mi">82</span><span class="o">,</span> <span class="mi">92</span>
<span class="n">Stream</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">24</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">76</span><span class="o">,</span> <span class="mi">54</span><span class="o">,</span> <span class="mi">90</span><span class="o">,</span> <span class="mi">40</span><span class="o">,</span> <span class="mi">98</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">34</span>
<span class="n">Stream</span> <span class="mi">2</span><span class="o">:</span> <span class="mi">60</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">46</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">91</span>

<span class="n">Seed</span><span class="o">:</span> <span class="mi">67890</span>
<span class="n">Stream</span> <span class="mi">0</span><span class="o">:</span> <span class="mi">54</span><span class="o">,</span> <span class="mi">68</span><span class="o">,</span> <span class="mi">74</span><span class="o">,</span> <span class="mi">56</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">63</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">47</span><span class="o">,</span> <span class="mi">21</span><span class="o">,</span> <span class="mi">96</span>
<span class="n">Stream</span> <span class="mi">1</span><span class="o">:</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">80</span><span class="o">,</span> <span class="mi">58</span><span class="o">,</span> <span class="mi">36</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">29</span><span class="o">,</span> <span class="mi">73</span>
<span class="n">Stream</span> <span class="mi">2</span><span class="o">:</span> <span class="mi">89</span><span class="o">,</span> <span class="mi">61</span><span class="o">,</span> <span class="mi">71</span><span class="o">,</span> <span class="mi">58</span><span class="o">,</span> <span class="mi">85</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">70</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">59</span><span class="o">,</span> <span class="mi">31</span>
</pre></div>


<p>This means you can start your game with one seed, and then lazily create
individual <span class="caps">PCG</span> instances for each level at the time you need them, without
worrying that your <span class="caps">PRNG</span> state has been messed up just by playing the&nbsp;game.</p>
<p>And once you&#8217;ve created a <span class="caps">PCG</span> instance, you only need to store two unsigned
integers! Serialization&#8217;s a&nbsp;snap.</p>
<h1 id="language-support">Language&nbsp;support</h1>
<p><span class="caps">PCG32</span> is very easy to implement, so it has broad language support, even though
the algorithm was only introduced in 2014. I wrote two implementations myself:
<a href="https://github.com/irskep/clubsandwich/blob/master/clubsandwich/pcg32.py">Python</a>
and <a href="https://github.com/irskep/RogueKit/blob/master/Sources/RogueKit/Util/PCG32.swift">Swift</a>.
But you should be able to find a good implementation for your favorite language
just by searching Google. And if you can&#8217;t find one, it really isn&#8217;t too hard
to do! It&#8217;s just a handful of bitwise&nbsp;operations.</p></div>
  </article></section>
    </div>

    <nav id="sidebar">
      <ul>
          <h3>Writing</h3>
            <li><a href="http://steveasleep.com/">Blog</a></li>
            <li><a href="http://steveasleep.com/pyglettutorial.html">Pyglet tutorial</a></li>
            <li><a href="http://steveasleep.com/resume.html">Résumé</a></li>
            <li><a href="http://steveasleep.com/game-jam-cv.html">Game jam CV</a></li>
          <h3>Projects</h3>
            <li><a href="http://sendimals.com">Sendimals</a></li>
            <li><a href="https://ldjam.com/events/ludum-dare/38/rogue-basement">Rogue Basement</a></li>
            <li><a href="http://literallycanvas.com/">Literally Canvas</a></li>
            <li><a href="http://steveasleep.com/computerwords">Computer Words</a></li>
            <li><a href="http://mrjob.readthedocs.org/">mrjob</a></li>
            <li><a href="http://hipmunk.github.io">Hipmunk OSS</a></li>
            <li><a href="http://steveasleep.com/games.html">Old games</a></li>
          <h3>Music</h3>
            <li><a href="http://thenestmusic.com">The Nest</a></li>
            <li><a href="http://slamjamsen.com">Slam Jamsen</a></li>
          <h3>External</h3>
            <li><a href="https://github.com/irskep">GitHub</a></li>
            <li><a href="https://twitter.com/irskep">Twitter</a></li>
            <li><a href="https://www.last.fm/user/irskep">last.fm</a></li>
            <li><a href="mailto:randos@steve.steveasleep.com">Email</a></li>
      </ul>
    </nav>

  </div>

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-4517625-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</body>
</html>